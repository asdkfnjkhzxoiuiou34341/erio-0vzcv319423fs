# Анализ и расшифровка файла `eblan` (MoonSec V3)

## Краткое резюме
Файл `eblan` содержит Lua-скрипт, защищенный обфускатором **MoonSec V3**. Это система защиты кода, которая делает исходный код практически нечитаемым для анализа.

## Технические характеристики файла
- **Размер**: 595,525 символов
- **Тип обфускации**: MoonSec V3
- **Язык**: Lua
- **Найдено функций**: 53
- **Вызовов loadstring**: 0

## Структура MoonSec V3
MoonSec V3 использует несколько уровней обфускации:

1. **Заголовок защиты**: `[[This file was protected with MoonSec V3]]`
2. **Байтовые последовательности**: Строки закодированы как escape-последовательности (`\xxx`)
3. **Обфусцированные имена функций**: Короткие переменные вместо понятных имен
4. **Математические операции**: Сложные арифметические выражения для скрытия логики
5. **Динамическая генерация**: Код генерируется во время выполнения

## Расшифрованные элементы

### Обнаруженные строковые константы:
- `tonumber` - функция преобразования в число
- `string` - работа со строками
- `char` - получение символа по коду
- `false` - логическое значение
- `sub` - подстрока
- `byte` - получение байт-кода символа
- `table` - работа с таблицами
- `concat` - объединение
- `insert` - вставка в таблицу

### Ключевые компоненты:
```lua
-- Основная структура декодера
local t = "tonumbervxJzjCBR stringcharkidfalMd stringsubEJtehsdg..."
local function n(z) -- Функция декодирования
    -- Сложная логика распаковки
end

-- Мапинг символов
local m = {}
for g=0x0,0xff do 
    local z = r.kidfalMd(g)
    m[g] = z
    m[z] = g
end
```

## Методы, использованные для расшифровки

### 1. Анализ байтовых последовательностей
- Поиск паттернов вида `\xxx` где xxx - числовой код символа
- Преобразование в соответствующие ASCII символы

### 2. Структурный анализ
- Выделение основных компонентов обфускации
- Поиск функций декодирования
- Анализ таблиц подстановки

### 3. Частичная деобфускация
- Замена escape-последовательностей
- Восстановление имен функций
- Улучшение читаемости кода

## Ограничения расшифровки

**Полная расшифровка MoonSec V3 невозможна** без выполнения кода по следующим причинам:

1. **Динамическая генерация**: Большая часть кода генерируется во время выполнения
2. **Многоуровневая защита**: Каждый уровень зависит от предыдущего
3. **Контрольные суммы**: Встроенные проверки целостности
4. **Антиотладочные механизмы**: Защита от статического анализа

## Заключение

Файл `eblan` успешно идентифицирован как защищенный MoonSec V3 Lua-скрипт. Выполнена частичная деобфускация, которая показала:

- Структуру системы защиты
- Основные методы обфускации
- Ключевые функции и константы

Для полной расшифровки потребовалось бы выполнение кода в контролируемой среде, что может быть небезопасно.

## Созданные файлы в процессе анализа:
1. `eblan_partially_decoded.lua` - частично декодированная версия
2. `eblan_quick_decoded.lua` - быстрая расшифровка
3. Различные аналитические скрипты Python

**Статус**: ✅ Файл успешно проанализирован и частично расшифрован