-- blade_ball_script.lua

-- Загружаем библиотеку MacLib
local MacLib = loadstring(game:HttpGet("https://github.com/biggaboy212/Maclib/releases/latest/download/maclib.txt"))()

-- Создаем главное окно
local Window = MacLib:Window({
    Title = "Blade Ball",
    Subtitle = "Free V1",
    Size = UDim2.fromOffset(868, 650),
    DragStyle = 1,
    DisabledWindowControls = {},
    ShowUserInfo = true,
    Keybind = Enum.KeyCode.RightControl,
    AcrylicBlur = true,
})

-- Создаем группу вкладок
local TabGroup = Window:TabGroup()

-- Создаем вкладки согласно инструкции
local CombatTab = TabGroup:Tab({
    Name = "Combat",
    Image = "swords"
})

local VisualsTab = TabGroup:Tab({
    Name = "Visuals",
    Image = "eye"
})

local SettingsTab = TabGroup:Tab({
    Name = "Settings",
    Image = "settings"
})

-- Создаем секции для вкладки Combat
local CombatSection = CombatTab:Section({
    Side = "Left"
})

-- Добавляем элементы в секцию Combat
local AutoParry = false
CombatSection:Toggle({
    Name = "Auto Parry",
    Default = false,
    Callback = function(Value)
        AutoParry = Value
        if Value then
            Window:Notify({
                Title = "Auto Parry",
                Description = "Авто-блокировка включена"
            })
        else
            Window:Notify({
                Title = "Auto Parry",
                Description = "Авто-блокировка выключена"
            })
        end
    end
})

local PredictionEnabled = false
CombatSection:Toggle({
    Name = "Ball Prediction",
    Default = false,
    Callback = function(Value)
        PredictionEnabled = Value
        -- Код для предсказания траектории мяча
    end
})

-- Слайдер для настройки времени блокировки
CombatSection:Slider({
    Name = "Parry Timing",
    Default = 0.2,
    Minimum = 0.1,
    Maximum = 1.0,
    Precision = 2,
    Callback = function(Value)
        ParryTiming = Value
    end
})

-- Секция для визуальных эффектов
local VisualsSection = VisualsTab:Section({
    Side = "Left"
})

VisualsSection:Toggle({
    Name = "Ball ESP",
    Default = false,
    Callback = function(Value)
        if Value then
            -- Включить ESP мяча
        else
            -- Выключить ESP мяча
        end
    end
})

VisualsSection:Toggle({
    Name = "Player ESP",
    Default = false,
    Callback = function(Value)
        if Value then
            -- Включить ESP игроков
        else
            -- Выключить ESP игроков
        end
    end
})

-- Секция для настроек
local SettingsSection = SettingsTab:Section({
    Side = "Left"
})

SettingsSection:Keybind({
    Name = "Toggle UI Keybind",
    Default = "RightShift",
    Callback = function(Key)
        Window:SetKeybind(Key)
    end
})

SettingsSection:Button({
    Name = "Destroy UI",
    Callback = function()
        Window:Destroy()
    end
})

-- Утилиты
SettingsSection:Button({
    Name = "Rejoin Server",
    Callback = function()
        game:GetService("TeleportService"):TeleportToPlaceInstance(game.PlaceId, game.JobId)
    end
})

-- Функция для поиска мяча
local function findBall()
    for _, obj in pairs(workspace:GetChildren()) do
        if obj.Name:find("Ball") or obj.Name:find("Sphere") then
            return obj
        end
    end
    return nil
end

-- Основной цикл для авто-блокировки
task.spawn(function()
    while task.wait() do
        if AutoParry then
            pcall(function()
                local ball = findBall()
                local character = game.Players.LocalPlayer.Character
                
                if ball and character and character:FindFirstChild("HumanoidRootPart") then
                    local distance = (ball.Position - character.HumanoidRootPart.Position).Magnitude
                    
                    if distance < 20 then
                        -- Код для блокировки
                        keypress(0x45) -- E key
                        task.wait(ParryTiming or 0.2)
                        keyrelease(0x45)
                    end
                end
            end)
        end
    end
end)

Window:Notify({
    Title = "Blade Ball Utilities",
    Description = "Меню загружено успешно!"
})
