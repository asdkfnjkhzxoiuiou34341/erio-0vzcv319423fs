-- blade_ball_script.lua

-- Загружаем библиотеку MacLib
local MacLib = loadstring(game:HttpGet("https://github.com/biggaboy212/Maclib/releases/latest/download/maclib.txt"))()

-- Создаем главное окно
local Window = MacLib:Window({
    Title = "Blade Ball",
    Subtitle = "Free V1",
    Size = UDim2.fromOffset(600, 400),
    DragStyle = 1,
    DisabledWindowControls = {},
    ShowUserInfo = true,
    Keybind = Enum.KeyCode.RightControl,
    AcrylicBlur = true,
})

-- Создаем группу вкладок
local TabGroup = Window:TabGroup()

-- Создаем вкладки с правильным синтаксисом
local CombatTab = TabGroup:Tab({
    Name = "Combat",
    Image = "rbxassetid://6034818372" -- Используем правильный формат для изображения
})

local VisualsTab = TabGroup:Tab({
    Name = "Visuals", 
    Image = "rbxassetid://6034818398" -- Используем правильный формат для изображения
})

local SettingsTab = TabGroup:Tab({
    Name = "Settings",
    Image = "rbxassetid://6034818378" -- Используем правильный формат для изображения
})

-- Создаем секции для вкладки Combat
local CombatSection = CombatTab:Section({
    Side = "Left"
})

-- Добавляем элементы в секцию Combat
local AutoParry = false
local AutoParryToggle = CombatSection:Toggle({
    Name = "Auto Parry",
    Default = false,
    Callback = function(Value)
        AutoParry = Value
        if Value then
            Window:Notify({
                Title = "Auto Parry",
                Description = "Авто-блокировка включена",
                Style = "Confirm"
            })
        else
            Window:Notify({
                Title = "Auto Parry", 
                Description = "Авто-блокировка выключена",
                Style = "Cancel"
            })
        end
    end
})

local PredictionEnabled = false
local PredictionToggle = CombatSection:Toggle({
    Name = "Ball Prediction",
    Default = false,
    Callback = function(Value)
        PredictionEnabled = Value
    end
})

-- Слайдер для настройки времени блокировки
local ParryTiming = 0.2
local TimingSlider = CombatSection:Slider({
    Name = "Parry Timing",
    Default = 0.2,
    Minimum = 0.1,
    Maximum = 1.0,
    Precision = 2,
    Callback = function(Value)
        ParryTiming = Value
    end
})

-- Создаем секции для вкладки Visuals
local VisualsSection = VisualsTab:Section({
    Side = "Left"
})

local BallESPToggle = VisualsSection:Toggle({
    Name = "Ball ESP",
    Default = false,
    Callback = function(Value)
        -- Включить/выключить ESP мяча
    end
})

local PlayerESPToggle = VisualsSection:Toggle({
    Name = "Player ESP",
    Default = false,
    Callback = function(Value)
        -- Включить/выключить ESP игроков
    end
})

-- Создаем секции для вкладки Settings
local SettingsSection = SettingsTab:Section({
    Side = "Left"
})

local KeybindButton = SettingsSection:Keybind({
    Name = "Toggle UI Keybind",
    Default = Enum.KeyCode.RightShift, -- Используем Enum вместо строки
    Callback = function(Key)
        Window:SetKeybind(Key)
    end
})

local DestroyButton = SettingsSection:Button({
    Name = "Destroy UI",
    Callback = function()
        Window:Destroy()
    end
})

local RejoinButton = SettingsSection:Button({
    Name = "Rejoin Server",
    Callback = function()
        game:GetService("TeleportService"):TeleportToPlaceInstance(game.PlaceId, game.JobId)
    end
})

-- Функция для поиска мяча
local function findBall()
    for _, obj in pairs(workspace:GetChildren()) do
        if obj.Name:find("Ball") or obj.Name:find("Sphere") then
            return obj
        end
    end
    return nil
end

-- Основной цикл для авто-блокировки
task.spawn(function()
    while task.wait() do
        if AutoParry then
            pcall(function()
                local ball = findBall()
                local character = game.Players.LocalPlayer.Character
                
                if ball and character and character:FindFirstChild("HumanoidRootPart") then
                    local distance = (ball.Position - character.HumanoidRootPart.Position).Magnitude
                    
                    if distance < 20 then
                        -- Код для блокировки
                        keypress(0x45) -- E key
                        task.wait(ParryTiming)
                        keyrelease(0x45)
                    end
                end
            end)
        end
    end
end)

Window:Notify({
    Title = "Blade Ball Utilities",
    Description = "Меню загружено успешно!",
    Style = "Confirm"
})
